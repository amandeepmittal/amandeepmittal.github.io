{"data":{"markdownRemark":{"html":"<p><img src=\"https://cdn-images-1.medium.com/max/2560/1*aeWo6e6FC8InJwBl3TmpDw.jpeg\"></p>\n<p>When I started learning <a href=\"http://www.nodejs.org\">Node.js</a>, I always wondered, how does it work? How is it inside Node.js? <em>Event loop and Event Queue</em> jargons are digested. But what exactly is going on? Where do those jargons <em>Event Loop and Event Queue</em> come from.To satisfy my curiosity as well to know the answer to my previous question, I went in depth as much as I can and came across some things which I’d like to share with you. In brief, this article is about **Node.js System **— a glimpse of internal workings of Node.</p>\n<p>If you are familiar with Node.js, it is a known fact that Node.js is single threaded. If you are from programming/computer science background you know what a thread means. Consider this scenario: traditionally — an I/O request comes to a web server and is assigned to an available thread, and for each concurrent connection there is one thread available. That request is handled on the specific thread until it is fulfilled and the response is sent.</p>\n<p>This scenario is a perfect example of <strong>Blocking I/O</strong> because while handling a particular request by a specific thread, there will be some idle time when the operations are being done <em>(such as retrieving a file, opening it, reading it, etc.).</em> A single thread consumes memory. A longer running thread for each connection and then sitting idly for some amount of time is not considered an efficient way in the <a href=\"https://medium.com/@amanhimself/the-node-way-philosophy-of-a-platform-f9738ed5f9d2#.w77h292q9\">world of Node.js.</a></p>\n<h4 id=\"enter-reactor-pattern--heart-of-nodejs\"><a href=\"#enter-reactor-pattern--heart-of-nodejs\" aria-label=\"enter reactor pattern  heart of nodejs permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enter Reactor Pattern- Heart of Node.js</h4>\n<p><strong>Reactor Pattern</strong> is an idea of non-blocking I/O operations in Node.js. This pattern provides a handler<em>(in case of Node.js, a</em> <strong><em>callback function</em></strong><em>)</em> that is associated with each I/O operation. When an I/O request is generated, it is submitted to a <em>demultiplexer</em>.</p>\n<p>This <em>demultiplexer</em> is a notification interface that is used to handle concurrency in <em>non-blocking I/O</em> mode and collects every request in form of an event and queues each event in a queue. Thus, the demultiplexer provides the <strong>Event Queue</strong>, which we often hear. When a request is collected by the demultiplexer, it returns the control back to the system and does not blocks the I/O. At the same time, there is an <strong>Event Loop</strong> which iterates over the items in the Event Queue. Every event has a callback function associated with it, and that callback function is invoked when the Event Loop iterates.</p>\n<p>The callback function further mostly have other callbacks associated within representing some asynchronous operations. These operations are inserted in the Event Queue by the demultiplexer and are ready to be processed once the Event Loop iterates over them. That is why calls to other operations must be asynchronous.</p>\n<p>When all the items in the Event Queue are processed and there are no pending operations left, Node.js terminates the application automatically.</p>\n<h3 id=\"building-blocks-of-nodejs\"><a href=\"#building-blocks-of-nodejs\" aria-label=\"building blocks of nodejs permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building Blocks of Node.js</h3>\n<ul>\n<li>Reactor Pattern</li>\n<li>libuv</li>\n<li>A set of Bindings</li>\n<li>Chrome’s V8</li>\n<li>Core JS Library</li>\n</ul>\n<h4 id=\"libuv\"><a href=\"#libuv\" aria-label=\"libuv permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"http://docs.libuv.org/en/v1.x/\"><em>libuv</em></a></h4>\n<p>Pronounced as “lib u v”, is library written in C language to make Node.js compatible with every OS and provide the non-blocking I/O behaviour. <a href=\"http://docs.libuv.org/en/v1.x/\"><em>libuv</em></a> is the low-level engine that implements <em>reactor pattern</em> thus providing an API for creating the Event Loop, managing an Event Queue and running asynchronous I/O operations. It is built specifically to provide a unified experience over different Operating Systems.</p>\n<h4 id=\"need-for-libuv\"><a href=\"#need-for-libuv\" aria-label=\"need for libuv permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Need for libuv?</h4>\n<p>Each operating system has its own interface for the demultiplexer. Such as <a href=\"https://en.wikipedia.org/wiki/Kqueue\">Kqueue</a> for Mac OS X, <a href=\"https://en.wikipedia.org/wiki/Input/output_completion_port\">IOCP</a> for Windows and <a href=\"https://en.wikipedia.org/wiki/Epoll\">Epoll</a> for Linux. Different multiplexers will behave differently when handling an I/O request. And then, each I/O operation can differ in its behaviour within the same operating system. This creates an inconsistency and to overcome this inconsistency <em>libuv</em> is the solution.</p>\n<p><em>I am not going to talk about internal workings of libuv here, not an expert on that, myself. For more info on libuv</em> <a href=\"http://docs.libuv.org/\"><em>check their docs</em></a> <em>or</em> <a href=\"http://www.slideshare.net/saghul/libuv-nodejs-and-everything-in-between\"><em>this slide</em></a> <em>by</em> <strong><em>Saúl Ibarra Corretgé</em></strong> <em>(</em><a href=\"https://twitter.com/saghul\"><em>@saghul</em></a><em>) is a good start.</em></p>\n<p><a href=\"https://github.com/libuv/libuv\"><em>Also, libuv is independently maintained by awesome developers.</em></a></p>\n<h4 id=\"set-of-bindings\"><a href=\"#set-of-bindings\" aria-label=\"set of bindings permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Set of Bindings</h4>\n<p>These set of bindings are responsible for wrapping and exposing <em>libuv</em> and other low-level functionality to JavaScript.</p>\n<h4 id=\"v8\"><a href=\"#v8\" aria-label=\"v8 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>V8</h4>\n<p>It’s a <a href=\"https://developers.google.com/v8/\">runtime engine developed by Google for Chrome</a> browser for JavaScript. It is the reason Node.js is fast and efficient.</p>\n<h4 id=\"core-library\"><a href=\"#core-library\" aria-label=\"core library permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Core Library</h4>\n<p>This is a JavaScript library that implements high-level Node.js API (<em>a.k.a. node-core</em>).</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/800/1*dTYKv5fII4doUAqJSA51Qg.png\" alt=\"More accurate image of Event Loop inside Node.js\"></p>\n<p>More accurate image of Event Loop inside Node.js</p>\n<p>The image borrowed above clarifies and represents a complete Node.js System. I hope this article has made things more clear as it did to me.</p>\n<hr>\n<p><strong><a href=\"https://hackernoon.com/the-node-js-system-51090c35dddc\">Originally Published at Hackernoon.com</a></strong></p>","timeToRead":4,"excerpt":"When I started learning  Node.js , I always wondered, how does it work? How is it inside Node.js?  Event loop and Event Queue  jargons are…","frontmatter":{"title":"The Node.js System","thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAD7klEQVQ4y3VUXUwUVxQeFiM8+eZTH+pL35rGaLWV7Nw7syw1Wgz+pBRrTa1rrD6oEKWttZUHaURgl/11AYmlP1Y2kjQiMSYSk92ZXXaxrGAMtKGJXaK2aVI1WiOyzh7PuTMDo0knOcm9d875zs93zpEk/M6kt0tBTaWjFNVqpS6dl0vWF9ZqXgvqynBQ578HdY/bfg/obElIrxFnv+aW+kZ3SN9n9ktSSK+2dSQ0dHVkVpXROZKqq8D71wj+X2xchUhOEYJvP4R07+u2DTmP6rXW2QyKQMsCurt8EVitR8WZnpseCI1y6NLZcxSDpHvSA+SkC53FtM2VpN+eXlmGNi7buMwB9DamNhLPeyB6XSGgeQsILCmhFEMZDj0m8Aw5X7BPKyZWSPMux1TiQVSM3/DYET13gDgFLCfz0TEFTudVAh7B+q501E7t7595zwYqOgydIEKC6ZfeSH/+zK1qAr2dnR6001YumJ5Eig4gjiRwcAL6kwLUBhbRUp1RbzYxfqDSIkUZoFRRyYxOIwPFEZUCgRSDyBiDo/0MfEdlCGUZvZXQxghnSZcXBm80LTUj1JRE3xTWTmPFYAYNcxw6ku9AQHMLwPbkWiAi4pMMmrsZbPlYhnCOCcGIje6b1E68MDDWVCEAsb8SJy95oK5BLm7fx6B1uAq+yzfA7P08/P3oNzg34YO2q+tg95cMata7oWGfLBztbZGhdpvbOBzBlNO8cH7UAoxPqIlPGlX49HO5+KFPgZ3H3oTph0Pwxz8ZmPrrKtybuw5729+CLR9x2N8qwwc+GY4PMFi/UYZdR7ix5yssjcYLF6cOmYCxX5XEZ8dVaEmwYmNQgT0nVsG12TZ4/PQ+PJl7ALl7fXDk7Gqoq+eUBexqlqHtCoP3t8qw86BZQySm0DvUWGGznIjmsIZISgAJ6bzGoVN7F3651QzD0y3QmVon6vXNzwwOdsqCILq3DuHdLxtdGtYwwws/JpsWAM93T4iGFiwjMSVql/bkGjiVXE31ETULI8uxcbNtkMASMl2K5bkRGRMs3x6cWIzwYt+Ul4yeOkYNW0IphdLqYh9qZqssNDaC4v0ZLQ8M4N8L44eX2pPiQQ9/0nxSe/zPtLw6NWJhmJnxOQyqyVo5TAx0TKurxMcW/PnESt9wzDO8MsfF09ZKQ5tzuM5WEMa3qTfsnaa4FuZa865ApZ9ImYysaA0LcJ7eraiyuBD44l6UzfWHrFrj58WdKC9xLAyORqNkHKZIkIieSbEE7uI/n63nT1eVI7DL2ouS1Juqx/VVLXWk11pAHpdfr3Iu290Icgeje4aRn4roG5bR+xdZQWb55ZFee0lj2TZJLwB1bCjmez/prQAAAABJRU5ErkJggg==","width":150,"height":150,"src":"/static/517c02bd875932e2a959488763695b28/0b2cc/node.png","srcSet":"/static/517c02bd875932e2a959488763695b28/0b2cc/node.png 1x"}}},"slug":"the-nodejs-system","date":"2016-04-22T00:00:00.000Z","categories":["Node.js"],"tags":["nodejs","hackernoon"],"template":"post"},"fields":{"nextTitle":"The Node Way - Philosophy of a Platform","nextSlug":"/wordpress-from-scratch-part-two/","prevTitle":"How process.nextTick() works in Node.js?","prevSlug":"/how-process-next-tick-works-in-nodejs/","slug":"/the-nodejs-system/","date":"2016-04-22T00:00:00.000Z"}}},"pageContext":{"slug":"/the-nodejs-system/"}}