{"componentChunkName":"component---src-templates-post-js","path":"/getting-started-with-express-part-5","webpackCompilationHash":"c3a562291cd8e443a353","result":{"data":{"site":{"siteMetadata":{"title":"Aman Mittal - Fullstack Developer","description":"Aman Mittal - Developer and Technical writer.","author":{"name":"Aman Mittal"},"keywords":["Fullstack Developer"]}},"mdx":{"frontmatter":{"title":"Getting Started With Express Part 5","date":"August 08, 2018","author":"Aman Mittal","banner":null,"slug":"getting-started-with-express-part-5","keywords":null},"code":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"getting-started-with-express-part-5\",\n  \"date\": \"2018-08-08T00:00:00.000Z\",\n  \"title\": \"Getting Started With Express Part 5\",\n  \"categories\": [\"nodejs\"],\n  \"description\": \"---\",\n  \"published\": true,\n  \"author\": \"Aman Mittal\",\n  \"banner\": null\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the last part of this tutorial series, we created two routes to fetch and add books to our bare minimum application. We had already connected MongoDB database in Part 4 by defining a schema and creating a model to connect with the routes. In this part, we are going to work with HTML forms.\"), mdx(\"p\", null, \"To see if everything is working, open an instance of your server side app using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"npm run devstart\"), \" script and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"mongod\"), \" instance. After that, visit URL \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localost:3001/books\"), \" in your browser and you will get the following result.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://i.imgur.com/zVeDNHL.png\",\n    \"alt\": \"ss1\"\n  }))), mdx(\"h2\", null, \"What are HTML forms?\"), mdx(\"p\", null, \"An HTML form is a group of fields or elements described as HTML tags on a web page that a user can interact with to add or update to our application. This mechanism allows us to collect user input data in various forms such as checkboxes, radio buttons, text input fields, user id/email, password, etc. Forms are considered a secure way of sharing data with the server. To submit a form from the client to server we make use of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"POST\"), \" HTTP request.\"), mdx(\"p\", null, \"A form in HTML is made of as a collection of HTML elements inside \", mdx(\"form\", null, \"...\"), \" tag. It contains at least one element of type=\\\"submit\\\".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-HTML\"\n  }), \"<form action=\\\"/url\\\" method=\\\"post\\\">\\n    <label for=\\\"name\\\">Enter name: </label>\\n    <input id=\\\"name\\\" type=\\\"text\\\" name=\\\"name\\\" placeholder=\\\"Enter your name here\\\">\\n    <input type=\\\"submit\\\" value=\\\"OK\\\">\\n</form>\\n\")), mdx(\"p\", null, \"Above example is a basic HTML form that accepts a user to enter their name and submit it by pressing the input button. The submit input will be displayed as a button. The form attributes define the HTTP method used to send the data which is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"POST\"), \" and the destination of the data on the server, that is the URL.\"), mdx(\"h2\", null, \"Building an Add Book Form\"), mdx(\"p\", null, \"Since we are using a template engine, Pug, in our application to display data from the server to client, we will be creating the form using it. There is no difference except the indentation of tags and elements when it comes to writing a form using Pug. In \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"index.pug\"), \" add the below code:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-pug\"\n  }), \"extends layout\\n\\nblock content\\n  h1= title\\n  p Welcome to #{title}\\n\\n  hr\\n  h2 Add a book\\n\\n  form(method='POST' action='/books/add')\\n          div.form-group\\n            label(for='title') Title\\n            br\\n            input.form-control(type='text' id='title' placeholder='title' name='title')\\n          br\\n          div.form-group\\n            label(for='author') Author Name\\n            br\\n            input.form-control(type='author' id='author' placeholder='author' name='author')\\n          br\\n          div.form-group\\n            label(for='summary') Book Sumary\\n            br\\n            textarea.formControl(name=\\\"summary\\\", cols=\\\"30\\\", rows=\\\"2\\\")\\n          br\\n          div.form-group\\n            label(for='isbn') ISBN\\n            br\\n            input.form-control(type='isbn' id='isbn' placeholder='isbn' name='isbn')\\n          button.btn.btn-primary(type='submit') Add\\n\")), mdx(\"p\", null, \"Here we are using four fields which we will be submitting in our route. Now add the values to each field like the below screenshot:\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://i.imgur.com/R7VjKwk.png\",\n    \"alt\": \"ss2\"\n  }))), mdx(\"p\", null, \"Since we already have setup our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/books/add\"), \" route in the books route controller, we will be prompted with a success message like in the below screenshot.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://i.imgur.com/tMjqLvt.png\",\n    \"alt\": \"ss3\"\n  }))), mdx(\"p\", null, \"Our form is using the same techniques as for displaying information through our models by using our routes in a controller file. The route sends the input data to the controller which performs any action required to add data to the database. It might sound a bit complicated if you are a beginner but remember all this is happening in split seconds and this is a universal mechanism to handle forms. To verify that the data has been submitted in the databases, we can visit URL \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:3001/books\"), \" to do so.\"), mdx(\"h2\", null, \"Adding Protection using helmet\"), mdx(\"p\", null, \"To make an Express server app secure, the most needed package we need is to install and use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"helmet\"), \". Helmet is a third party library that helps to protect your app from some well-known web vulnerabilities by setting HTTP headers appropriately. Helmet is actually just a collection of nine smaller middleware functions that set security-related HTTP headers. These middleware function include:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"csp sets the Content-Security-Policy header to help prevent cross-site scripting attacks and other cross-site injections.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"hidePoweredBy removes the X-Powered-By header.\\nhpkp Adds Public Key Pinning headers to prevent man-in-the-middle attacks with forged certificates.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"hsts sets Strict-Transport-Security header that enforces secure (HTTP over SSL/TLS) connections to the server.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"ieNoOpen sets X-Download-Options for IE8+.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"noCache sets Cache-Control and Pragma headers to disable client-side caching.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"noSniff sets X-Content-Type-Options to prevent browsers from MIME-sniffing a response away from the declared content-type.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"frameguard sets the X-Frame-Options header to provide clickjacking protection.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"xssFilter sets X-XSS-Protection to enable the Cross-site scripting (XSS) filter in most recent web browsers.\")), mdx(\"p\", null, \"To install helmet, run\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-shell\"\n  }), \"npm isntall -S helmet\\n\")), mdx(\"p\", null, \"To use it in our app, modify \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"app.js\"), \" like this:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"// ...\\n\\nvar helmet = require('helmet')\\napp.use(helmet())\\n\\n// ...\\n\")), mdx(\"p\", null, \"It's best to use Helmet early in your middleware stack so that its headers are sure to be set.\"), mdx(\"h2\", null, \"Input Validation\"), mdx(\"p\", null, \"Our last piece of form handling comes to handling input fields. We need to validate that the correct or valid fields are being entered by the user and not some random data in our form. Validation checks that entered values are appropriate for each field (are in the right range, format, etc.) and that values have been supplied for all required fields.\"), mdx(\"p\", null, \"We are going to use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"express-validator\"), \" to validate our form's input fields. Install the dependency:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-shell\"\n  }), \"npm install -S express-validator\\n\")), mdx(\"p\", null, \"To use the validator in our controllers we have to require the functions we want to use from the 'express-validator/check'. We will first use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"validationResult\"), \" from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"express-validator\"), \". Edit the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"bookController.js\"), \" file like this.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const Book = require('../models/book.model.js')\\n\\nconst { validationResult } = require('express-validator/check')\\n\\nexports.booksList = (req, res) => {\\n  Book.find()\\n    .then(data => {\\n      res.send(data)\\n    })\\n    .catch(err => {\\n      console.log(err)\\n      res.status(400).send('unable to fetch books')\\n    })\\n}\\n\\nexports.getBookById = (req, res) => {\\n  Book.findById({ _id: req.params.id })\\n    .then(data => {\\n      res.send(data)\\n    })\\n    .catch(err => {\\n      console.log(err)\\n      res.status(400).send('unable to fetch books')\\n    })\\n}\\n\\nexports.addBook = (req, res) => {\\n  let newBook = new Book(req.body)\\n  console.log(newBook)\\n\\n  const errors = validationResult(req)\\n  if (!errors.isEmpty()) {\\n    return res.status(422).json({ errors: errors.array() })\\n  }\\n\\n  newBook\\n    .save()\\n    .then(data => {\\n      res.send('Success: Data submitted')\\n    })\\n    .catch(err => {\\n      console.log(err)\\n      res.status(400).send('Error: unable to save data')\\n    })\\n}\\n\")), mdx(\"p\", null, \"validationResult is an object that takes the incoming request from the client. It then, check for errors coming from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"check\"), \" method of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"express-validator\"), \" which we are going to implement in a minute. If there are no errors, the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"if\"), \" condition is bypassed and the incoming data object is saved to the database as before. If there is an error caught by the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"if\"), \" condition, the data is not saved and it results in an error.\"), mdx(\"p\", null, \"Now, let us implement the second piece of this process. Edit \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"books.js\"), \" in the route folder.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const express = require('express')\\nconst router = express.Router()\\nconst { check } = require('express-validator/check')\\nconst bookController = require('../controllers/booksController.js')\\n\\n// GET ALL BOOKS titles\\nrouter.get('/', bookController.booksList)\\n\\n// GET a BOOK by id\\nrouter.get('/:id', bookController.getBookById)\\n\\nrouter.post(\\n  '/add',\\n  [check('title').isLength({ min: 1 })],\\n  bookController.addBook\\n)\\n\\nmodule.exports = router\\n\")), mdx(\"p\", null, \"In the above example, notice how we are implementing a check for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"title\"), \" field in our form. The check basically says that the title field must have a length of at least one character. Otherwise, the incoming request will no pass.\"), mdx(\"p\", null, \"In the below screenshot, we have left the title field empty. The validationResult runs, it throws an error.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://i.imgur.com/1hKTlGx.png\",\n    \"alt\": \"ss4\"\n  }))), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://javabeginnerstutorial.com/node-js/getting-started-with-express-part-5/\"\n  }), \"Originally published at javabeginnerstutorial.com\"))));\n}\n;\nMDXContent.isMDXComponent = true;"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"657b3fe3-947b-5cb2-9bcd-ae8f5cc69c6f","prev":{"id":"0caf3b71-d6b7-5196-a613-b77f2eea80f2","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"Redux is an important part of the React Native ecosystem. If your world revolves around JavaScript, you’ve probably heard about Redux. Before reading the rest of the tutorial and going further, just try to remember that you are only learning about…","fields":{"title":"How to integrate Redux into your application with React Native and Expo","slug":"how-to-integrate-redux-into-your-application-with-react-native-and-expo","date":"2018-08-10T00:00:00.000Z"},"code":{"scope":""}},"next":{"id":"0c17e7e4-ebcf-5941-99d8-2298ce6e4e18","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"This week has been a hectic one for me. Deadline coming closer, and too many tasks to complete. It has been a happening one also. I got the invite to join Gatsbyjs open source team, to help and maintain the on going projects. I love contributing to…","fields":{"title":"Week 3 with React Native: Why use Expo?","slug":"week-3-with-react-native","date":"2018-07-26T00:00:00.000Z"},"code":{"scope":""}}}}}