{"componentChunkName":"component---src-templates-post-js","path":"/accessing-geo-location-and-app-permissions-in-react-native-and-expo","webpackCompilationHash":"c3a562291cd8e443a353","result":{"data":{"site":{"siteMetadata":{"title":"Aman Mittal - Fullstack Developer","description":"Aman Mittal - Developer and Technical writer.","author":{"name":"Aman Mittal"},"keywords":["Fullstack Developer"]}},"mdx":{"frontmatter":{"title":"Accessing Geo-location and App Permissions in React Native and Expo","date":"September 20, 2018","author":"Aman Mittal","banner":null,"slug":"accessing-geo-location-and-app-permissions-in-react-native-and-expo","keywords":null},"code":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"accessing-geo-location-and-app-permissions-in-react-native-and-expo\",\n  \"date\": \"2018-09-20T00:00:00.000Z\",\n  \"title\": \"Accessing Geo-location and App Permissions in React Native and Expo\",\n  \"categories\": [\"react native\"],\n  \"description\": \"---\",\n  \"published\": true,\n  \"author\": \"Aman Mittal\",\n  \"banner\": null\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/2560/1*C7VCw7tXCF6H3jceCYY7Bg.jpeg\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"In web, Geolocation is provided as an API that has different methods to use in a web application. Similarly, React Native takes advantage of this API and is available as polyfills. Geolocation is a must have feature to implement in a mobile app. Few of the famous mobile apps that use it for more than 90% in terms of usage are Uber, Google Maps, etc. In this article, I will show how to integrate the Geolocation API in a React Native app in two ways. Using Expo and using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"react-native-cli\"), \". Along with that, I am going to implement a real time feature that is commonly used with these types of applications. Asking \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"user permissions\"), \". Permissions in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"react-native-cli\"), \" can be a bit tricky but after reading this article, it won't be tricky to you as much.\"), mdx(\"h3\", null, \"Getting Started With\\xA0Expo\"), mdx(\"p\", null, \"For this purpose, I am using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"expo-cli\"), \". Follow the below commands to set up an Expo project and get started.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-shell\"\n  }), \"npm install -g expo-cli\\n\\nexpo-cli init find-me\\n\\n# select blank template & traverse into a newly created directory\\n\\nnpm run ios\\n\\n# for Window users, run\\n\\nnpm run android\\n\")), mdx(\"p\", null, \"You will be welcomed with a default screen. We will start here. First, edit the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"App.js\"), \".\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*t-yXnKyzuPQ4QyWLEJqkTg.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"Create a new file for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"FindMe\"), \" component at \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src -> screens -> FindMe -> index.js\"), \". Inside this file, we will just display a text.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*DQ62hT6lGTGN1gl3dtXdRw.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"Here is how our app looks so far.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*L7myfguVDny9zkf0SZ-56A.png\",\n    \"alt\": null\n  }))), mdx(\"h3\", null, \"Accessing Geolocation API\"), mdx(\"p\", null, \"The Geolocation API exists as a global object called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"navigator\"), \" object in React Native, just like the web. It is accessible via \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"navigator.geolocation\"), \" in our source code and there is no need to import it.\"), mdx(\"p\", null, \"For our demonstration purposes, we will be using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getCurrentPosition\"), \" method from the geolocation API. This method allows a mobile app to request a user's location and accepts three parameters: success callback, error callback and a configuration object in the last.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*fvw2WN4oiQSiOno-F0tBaA.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"The first callback has a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"position\"), \" argument that is an object with the following properties.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-shell\"\n  }), \"{\\n  \\\"timestamp\\\": 1533729980953.91\\n  \\\"coords\\\": {\\n    \\\"accuracy\\\": 5,\\n    \\\"altitude\\\": 0,\\n    \\\"altitudeAccuracy\\\": -1,\\n    \\\"heading\\\": -1,\\n    \\\"latitude\\\": 37.785834,\\n    \\\"longitude\\\": -122.406417,\\n    \\\"speed\\\": -1\\n  }\\n}\\n\")), mdx(\"p\", null, \"Now, implement this in our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"FindMe\"), \" component.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*niawEqpzyk42BN6cp8cmdQ.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"We start be importing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TouchableOpcaity\"), \". It is a wrapper that responds accurately to user touches. In a mobile app, you will be making use of them. Think of it as a button in a web application. This newly imported wrapper accepts an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onPress\"), \" prop that is going to trigger the function defined as in the value, in our case \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"findCurrentLocation\"), \".\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"findCurrentLocation\"), \" holds the logic of fetching a user's location. We are also using the local state to display coordinates from the data provided to us by \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"position\"), \" object. The text \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Where Am I\"), \" now becomes clickable.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*CMCljDxK6AKqBFPcZpdAnQ.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"That\\u2019s it for the app part. Now let us see how to add permissions to the same application.\"), mdx(\"h3\", null, \"Using Expo Permissions\"), mdx(\"p\", null, \"Requesting to access a user\\u2019s information whether it is location or any other sensitive information on the device, it is your job as the developer to ask for the permissions first. It is one time process, both when developing the application and when the user is using the application. Most permissions are asked when the user installs the application run it for the first time.\"), mdx(\"p\", null, \"For us, Expo has integrated all the permission API we need for this demo app or any other app you are building using Expo. This API has different methods for device types of permissions to grant for. Such as location, camera, audio recording, contacts, camera roll, calendar, reminders (for ios only) and notifications. We are going to use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Location\"), \".\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*5FXyNeelAMMpvhHudlWZyw.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"We change our state a bit. It will not store the whole geolocation object and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"errorMessage\"), \" in case of an error. Our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"findCurrentLocation\"), \" remains the same. In fact, we are not using it. Expo has a method for us that does the same. It is called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getCurrentPositionAsync\"), \". It will only fetch the user's location and other properties made available by \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getCurrentPosition\"), \" method from Geolocation API and if the permission is granted. In the render method, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onPress\"), \" prop is now calling a different method \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"findCurrentLocationAsync\"), \" that holds the logic for asking permission and fetches the location data after the user has granted permission to our app to access it. If not, the error message is set otherwise the location in the state is updated.\"), mdx(\"p\", null, \"The last step is for android users. Open \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"app.json\"), \" and permissions.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*zRAdrOQmO2Ht94771FwfLQ.png\",\n    \"alt\": null\n  })), \"\\n\", mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*Uh3qovlCclxuOSrDl9_W-g.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"If you press allow, you will see the following result.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*9tcfI5LQ5YT4nkdUAliGwg.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"Note that in even in development mode and running the app in a simulator, the permissions are only asked once. To perform this again, you will have to delete the app from your simulator and re-run the command to start the expo app.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"You can find the complete code in this Github repository.\"), \"\\uD83D\\uDC47\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/amandeepmittal/find-me\",\n    \"title\": \"https://github.com/amandeepmittal/find-me\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"amandeepmittal/find-me\"), mdx(\"br\", {\n    parentName: \"a\"\n  }), \"_\", \"\\u269B\\uFE0F + \\uD83D\\uDCF1 Location + Permissions in Expo app. Contribute to amandeepmittal/find-me development by creating an account on\\u2026\", \"_\", \"github.com\"), mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/amandeepmittal/find-me\"\n  }))), mdx(\"h3\", null, \"Using \", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"react-native-cli\")), mdx(\"p\", null, \"Using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"react-native-cli\"), \" means you will have to set permissions on your own, however, the logic of getting a user's location is going to be the same.\"), mdx(\"p\", null, \"There are no templates in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"react-native-cli\"), \" so once the directory is generated, traverse into it and run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"npm start\"), \" to see if everything is installed correctly. The first thing you will notice when you open this project in an IDE or a code editor is that there is a vast amount of change in the structure of files and folders. Expo had a sort of minimal project structure as compared to this one. There are separate build folders such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/android\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/ios\"), \" for each platform. You can also use flow (which is similar to TypeScript, open sourced by Facebook).\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*HCrbkGlatt1GkoXXUoDxOw.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"We will only modify \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"App.js\"), \" file with the following code.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*-h2Av7ibSO46nmITcB_pbA.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"Observe that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"findCoordinates\"), \" works the same way as in Expo application and also the code in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"render()\"), \" function is exactly same. Our next step is to set permissions.\"), mdx(\"p\", null, \"In ios, geolocation is enabled by default when a project is created using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"react-native-cli\"), \". To use it, we just need to include a key in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"info.plist\"), \" which is inside the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ios/findCoordsApp\"), \" directory.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*El9k4ATwC18FZfwztwFFLA.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"For android, we need to add the following line in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"android/app/src/AndroidManifest.xml\"), \" file.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<uses-permission android:name=\\\"android.permission.ACCESS_FINE_LOCATION\\\" />\\n\")), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*6-zhbdDlRjOgsivgh8HuMw.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"Now if you run your application you will see the following screen.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*H931wEjHcVDXddtn9MgI4w.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"Click on the text and you will be prompted to ask whether to allow the application to request for user\\u2019s location or not. For the demonstration purpose, I am using an android Emulator since we have already seen how it works on ios Simulator in the Expo section.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*op9kur7KZeinIFvzjfsryg.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, \"If you press allow, you will see the following result.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://cdn-images-1.medium.com/max/800/1*WN-pTs6HekIS62dCrqm4uQ.png\",\n    \"alt\": null\n  }))), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"You can find the complete code in this Github repository.\"), \" \\uD83D\\uDC47\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/amandeepmittal/findCoordsApp\",\n    \"title\": \"https://github.com/amandeepmittal/findCoordsApp\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"amandeepmittal/findCoordsApp\"), mdx(\"br\", {\n    parentName: \"a\"\n  }), \"_\", \"\\u269B\\uFE0F + \\uD83D\\uDCF1 Location + Permissions in RN-CLI generated app - amandeepmittal/findCoordsApp_github.com\"), mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/amandeepmittal/findCoordsApp\"\n  }))), mdx(\"p\", null, \"If you want to learn more about working with Geolocation API in a React Native application, please go through the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://facebook.github.io/react-native/docs/geolocation\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"official documentation\")), mdx(\"strong\", {\n    parentName: \"p\"\n  }, \".\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.expo.io/versions/latest/sdk/permissions#__next\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"Expo\\u2019s Documentation\")), \" has a lot more on \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Permissions\"), \" too.\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://medium.com/react-native-training/accessing-geo-location-and-app-permissions-in-react-native-and-expo-e7a1bd4714a2\"\n  }), \"Originally published at React Native Training\"))));\n}\n;\nMDXContent.isMDXComponent = true;"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"843c5b82-490b-566b-8dde-8ae8e2c80364","prev":{"id":"fd527182-8581-51f5-a460-0071a7db93d5","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"In this tutorial, we are going to learn how to integrate and use  ng2-smart-tables  with Angular 6. The  ng2-smart-table  is a library that is available to us as an npm package and pre-defined components and directives for sorting, searching…","fields":{"title":"Smart Tables with Angular","slug":"smart-tables-with-angular","date":"2018-09-28T00:00:00.000Z"},"code":{"scope":""}},"next":{"id":"d6c2038b-e6e3-5be6-b78b-9abf3b8fb6c8","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"Recently, I have been working on a React Native application that demands a changeable theme based on the user selection. I wanted to do this in a simplest way possible. I have so far avoided any React Native UI toolkit such as NativeBase or React…","fields":{"title":"Simple Recipe to Build a Theme App in React Native","slug":"simple-recipe-to-build-a-theme-app-in-react-native","date":"2018-09-11T00:00:00.000Z"},"code":{"scope":""}}}}}