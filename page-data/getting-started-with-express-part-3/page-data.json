{"componentChunkName":"component---src-templates-post-js","path":"/getting-started-with-express-part-3","webpackCompilationHash":"c3a562291cd8e443a353","result":{"data":{"site":{"siteMetadata":{"title":"Aman Mittal - Fullstack Developer","description":"Aman Mittal - Developer and Technical writer.","author":{"name":"Aman Mittal"},"keywords":["Fullstack Developer"]}},"mdx":{"frontmatter":{"title":"Getting started with Express application Part 3: Connecting with Database","date":"June 24, 2018","author":"Aman Mittal","banner":null,"slug":"getting-started-with-express-part-3","keywords":null},"code":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"getting-started-with-express-part-3\",\n  \"date\": \"2018-06-24T00:00:00.000Z\",\n  \"title\": \"Getting started with Express application Part 3: Connecting with Database\",\n  \"categories\": [\"nodejs\"],\n  \"description\": \"---\",\n  \"published\": true,\n  \"author\": \"Aman Mittal\",\n  \"banner\": null\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"Introduction\"), mdx(\"p\", null, \"With an Expressjs application, you can make use of all popular databases available to perform several operations such Create, Read, Update and Delete (CRUD operations). This tutorial will provide an overview of a database we are going to use with our Expressjs application, called Mongodb. Further, we will be looking into pragmatic concepts like what is an ODM/ORM, Schemas, Models and connecting the MongoDB database with our Express application.\"), mdx(\"p\", null, \"Other popular options that we could use with Expressjs are PostgreSQL, MySQL, SQLite, Redis, etc.\"), mdx(\"h2\", null, \"How to interact with a Database using Server side framework like Expressjs\"), mdx(\"p\", null, \"Since there are many options with Express to use a database choosing the right database in the tech stack is important. But more important is to learn how to approach to interact with a database. There are two ways to do that. First, for database like SQL you can use native query language. Secondly, you can use an ORM or ODM in case of MongoDB.\"), mdx(\"p\", null, \"An ORM (Object Relational Mapper) or an ODM (Object Data Model) are helpful with connecting a database using JavaScript from inside the Express application. You can define a minimal configuration setting to set it up. Next, bigger advatange of an ODM is that they also help you to query Database from controllers directly in an Express application using a similar syntax to JavaScript. Here, there is no need to learn much native query language and ORM such as Sequelize can interact with different form of SQL databases.\"), mdx(\"p\", null, \"The benefit of using an ODM/ORM is that we developers can continue to think in terms of JavaScript objects rather than database native query language. This is helpful if you need to work with different databases and in real world, you will. Some examples of ORM/ODM are:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Mongoose for MongoDB\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Sequelize for PostgreSQL, MySQL, MariaDB, SQLite and MSSQL\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"WaterLine for Redis, mySQL, LDAP, MongoDB, and Postgres\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Bookshelf for PostgreSQL, MySQL, and SQLite3.\")), mdx(\"p\", null, \"For our example we will be using Mongoose an ODM from the above list. It is open source and free to use and popular in Node.js community.\"), mdx(\"h2\", null, \"MongoDB and Mongoose\"), mdx(\"p\", null, \"To use MongoDB, make sure you have it installed in your local machine. You can refer the official documentation for that or if on mac, you can use a tool like Homebrew. MongoDB is a NoSQL database that stores information in the form of documents. Each documents can contain various fields and nested fields to represent the stored information. There can be different documents stored in a collection. A MongoDB database as whole will contain multiple collections. These collection of documents will be similar to a table of rows if you are familiar with SQL databases.\"), mdx(\"h2\", null, \"Connecting the Database\"), mdx(\"p\", null, \"To start using mongoose, we will begin by installing it in our project.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-shell\"\n  }), \"npm install -S mongoose\\n\")), mdx(\"p\", null, \"We will now make a database connection. Create a file called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"dbconfig.js\"), \" inside \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"config/\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"const mongoose = require('mongoose')\\n\\n// define connection URI string\\nconst DBURI = 'mongodb://localhost/nodejsexample'\\n\\n// open mongoose connection\\nmongoose.connect(DBURI)\\n\\n// Listen to CONNECTION EVENTS\\n// When successfully connected\\nmongoose.connection.on('connected', () => {\\n  console.log('Mongoose Default Connection with : ' + DBURI)\\n})\\n\\n// When connection throws an error\\nmongoose.connection.on('error', err => {\\n  console.log('Mongoose Default Connection Error : ' + err)\\n})\\n\\n// When connection is disconnected\\nmongoose.connection.on('disconnected', () => {\\n  console.log('Mongoose Default Disconnected')\\n})\\n\")), mdx(\"p\", null, \"Then we will require this file in our app.js such that when the server runs, the database connection is made. Mongoose provides different cases for each common scenarios by emitting events such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"connected\"), \" when the database is connected, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"error\"), \" when there is an when connecting to a database (currently, we are using a local database instance, but in practical use case you data will be stored in cloud service such mlab, etc.) and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"disconnected\"), \" when an interuption occurs while the server is running.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// require it after you require other dependencies but before other configuration\\n\\nrequire('./config/db.config.js')\\n\\nvar app = express()\\n\")), mdx(\"p\", null, \"Now, if you run the devserver from the terminal:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-shell\"\n  }), \"npm run devstart\\n\")), mdx(\"p\", null, \"You will notice a new message prompt that says \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Mongoose Default Connection with : mongodb://localhost/nodejsexample\"), \".\"), mdx(\"h2\", null, \"Defining a Local Schema\"), mdx(\"p\", null, \"We will now define a schema inside a directory called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"models\"), \", naming it \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"book.model.js\"), \". You can use any any name, it is just a convention we are using in this example to name our file.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"var mongoose = require('mongoose')\\n\\nvar Schema = mongoose.Schema\\n\\nvar BookSchema = new Schema({\\n  title: { type: String, required: true },\\n  author: { type: String, required: true },\\n  summary: { type: String, required: true },\\n  isbn: { type: String, required: true },\\n  genre: [{ type: String }]\\n})\\n\\n//Export model\\nmodule.exports = mongoose.model('Book', BookSchema)\\n\")), mdx(\"p\", null, \"To define a schema, every time, we need to require Mongoose in each schema file. Mongoose Provides a constructor method to define the Schema, like above in our example, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"BookSchema\"), \". Next, Mongoose also provides data types that are necessary to define since NoSQL database like MongoDB is actually schemaless. So these neccessaties are needed to be defined with our Server application. Note the data type we are using type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"String\"), \".\"), mdx(\"p\", null, \"We can also provide attributes such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"required\"), \" in our example that enforces the database to accept data only if the field is provided through our API. For example, consider a form when adding a book's detials and we forget to provide author of the book. On our frontend we have to make a custom error fields to display the message to the user but in our backend, the database will not store the data. Such is another commonly used attribute called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unique\"), \".\"), mdx(\"p\", null, \"Each document in our database will be having a unique id that is going to be auto generated by MongoDB. But in any other scenario, you want to generate an id from the server side using a different convention you do like this:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"_id: mongoose.Schema.Types.ObjectId,\\n    name: {\\n            firstName: String,\\n        lastName: String\\n    }\\n\")), mdx(\"p\", null, \"Notice \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"_id\"), \" field name. Mongodb stores the unique identifier as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"_id\"), \" which has a datatype of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ObjectId\"), \". By default, this datatype is a 12 byte Binary BSON type and is used as a primary key. In your database, you might find it as a string like this:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"\\\"_id\\\": ObjectId(\\\"54759eb3c090d83494e2d804\\\")\\n\")), mdx(\"p\", null, \"Mongoose also allows flexibility to create schemas with arrays. In our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"genre\"), \" field, we can have different String names such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Fiction\"), \" along with sub genres such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Mystery\"), \" which relates to the overall schema.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"module.exports = mongoose.model('Book', BookSchema)\\n\")), mdx(\"p\", null, \"Lastly, we export our schema by defining a model. The first argument is the singular name of the schema. This is schema name will also be the collection name we are going to use in our API to query the database. Mongoose searches for the plural version of the model name automatically. Thus, for the example above, the model \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Book\"), \" is for the books collection in the database. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".model()\"), \" method makes a copy of schema. We have to make sure that every field is added to schema before calling \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"mongoose.model()\"), \" method.\"), mdx(\"p\", null, \"This completes our Book Model. In the next tutorial, we will be using this schema to perform CRUD operations with our database.\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://javabeginnerstutorial.com/node-js/getting-started-with-express-part-3/\"\n  }), \"Originally published at javabeginnerstutorial.com\"))));\n}\n;\nMDXContent.isMDXComponent = true;"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"a51ca0d4-5648-559b-84d1-9116421a3848","prev":{"id":"c02046c7-e7be-5cd6-acd0-cdc88ee4effe","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"In the previous article, we learned how we can leverage ODM like Mongoose to connect the database to our Express server web application and define schema and model inside our web application to interact with the MongoDB database. In this tutorial, we…","fields":{"title":"Getting Started With Express Part 4","slug":"getting-started-with-express-part-4","date":"2018-06-28T00:00:00.000Z"},"code":{"scope":""}},"next":{"id":"6f3d38a5-3001-5ea7-9176-0c662c2098fd","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"Uploading Files might seem a task that needs to be conquered especially if you are getting into web development. In this tutorial, simple AJAX based file uploads using Reactjs on front-end and Node.js back-end. This is easy to accomplish with the…","fields":{"title":"How to Upload a File with Reactjs and Nodejs","slug":"connecting-a-node-js-and-reactjs-example","date":"2018-06-23T00:00:00.000Z"},"code":{"scope":""}}}}}